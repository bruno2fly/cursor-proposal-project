(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,29044,e=>{"use strict";var t=e.i(19873);let s={draft:{bg:"bg-gray-500/10",text:"text-gray-400"},sent:{bg:"bg-blue-500/10",text:"text-blue-400"},viewed:{bg:"bg-yellow-500/10",text:"text-yellow-400"},accepted:{bg:"bg-green-500/10",text:"text-green-400"},declined:{bg:"bg-red-500/10",text:"text-red-400"}};function r({status:e}){let r=s[e]||s.draft;return(0,t.jsx)("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium capitalize ${r.bg} ${r.text}`,children:e})}e.s(["default",()=>r])},33094,(e,t,s)=>{t.exports=e.r(90353)},13922,e=>{"use strict";var t=e.i(19873),s=e.i(11833),r=e.i(33094);function a({proposal:e}){let a=(0,r.useRouter)(),l=!!e,[d,i]=(0,s.useState)([]),[n,c]=(0,s.useState)(!1),[o,x]=(0,s.useState)(""),[m,p]=(0,s.useState)(e?.client_name||""),[u,h]=(0,s.useState)(e?.slug||""),[b,g]=(0,s.useState)(e?.hero_title||"360Â° Marketing Service"),[v,j]=(0,s.useState)(e?.hero_subtitle||""),[N,f]=(0,s.useState)(e?.custom_note||""),[_,k]=(0,s.useState)(e?.status||"draft"),[y,w]=(0,s.useState)(e?.pricing_option_1_name||"3-Month Agreement"),[S,C]=(0,s.useState)(e?.pricing_option_1_price||1100),[P,E]=(0,s.useState)(e?.pricing_option_1_desc||"Commit to growth with our recommended partnership plan."),[$,T]=(0,s.useState)(e?.pricing_option_2_name||"Month-to-Month"),[B,D]=(0,s.useState)(e?.pricing_option_2_price||1400),[A,O]=(0,s.useState)(e?.pricing_option_2_desc||"Flexible month-to-month plan with no long-term commitment."),[F,L]=(0,s.useState)({});(0,s.useEffect)(()=>{fetch("/api/service-templates").then(e=>e.json()).then(t=>{if(i(t),e?.proposal_services){let s={};t.forEach(t=>{let r=e.proposal_services?.find(e=>e.service_id===t.id);s[t.id]={enabled:!r||r.enabled,sort_order:r?r.sort_order:t.sort_order,custom_summary:r?.custom_summary||""}}),L(s)}else{let e={};t.forEach(t=>{e[t.id]={enabled:!0,sort_order:t.sort_order,custom_summary:""}}),L(e)}}).catch(console.error)},[e]),(0,s.useEffect)(()=>{!l&&m&&h(m.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,""))},[m,l]);let R=async t=>{t.preventDefault(),c(!0),x("");let s=Object.entries(F).map(([e,t])=>({service_id:e,enabled:t.enabled,sort_order:t.sort_order,custom_summary:t.custom_summary||null}));try{let t=l?`/api/proposals/${e.id}`:"/api/proposals",r=l?"PATCH":"POST",d=await fetch(t,{method:r,headers:{"Content-Type":"application/json"},body:JSON.stringify({client_name:m,slug:u,status:_,hero_title:b,hero_subtitle:v||null,custom_note:N||null,pricing_option_1_name:y,pricing_option_1_price:S,pricing_option_1_desc:P,pricing_option_2_name:$,pricing_option_2_price:B,pricing_option_2_desc:A,services:s})});if(!d.ok){let e=await d.json();throw Error(e.error||"Failed to save")}a.push("/admin"),a.refresh()}catch(e){x(e instanceof Error?e.message:"Failed to save")}finally{c(!1)}},M="w-full px-4 py-2.5 rounded-lg bg-dark-bg border border-dark-border text-white text-sm focus:outline-none focus:border-accent-purple transition-colors",V="block text-sm text-dark-text-light mb-1.5";return(0,t.jsxs)("form",{onSubmit:R,className:"space-y-8",children:[o&&(0,t.jsx)("div",{className:"text-sm text-red-400 bg-red-400/10 border border-red-400/20 rounded-lg p-3",children:o}),(0,t.jsxs)("div",{className:"bg-dark-card border border-dark-border rounded-2xl p-6",children:[(0,t.jsx)("h2",{className:"font-clash text-lg font-semibold mb-4",children:"Basic Information"}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:V,children:"Client Name *"}),(0,t.jsx)("input",{type:"text",value:m,onChange:e=>p(e.target.value),className:M,required:!0,placeholder:"e.g. SUPERCRISP"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:V,children:"Slug *"}),(0,t.jsx)("input",{type:"text",value:u,onChange:e=>h(e.target.value),className:M,required:!0,placeholder:"e.g. supercrisp-q1-2025"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:V,children:"Status"}),(0,t.jsxs)("select",{value:_,onChange:e=>k(e.target.value),className:M,children:[(0,t.jsx)("option",{value:"draft",children:"Draft"}),(0,t.jsx)("option",{value:"sent",children:"Sent"}),(0,t.jsx)("option",{value:"viewed",children:"Viewed"}),(0,t.jsx)("option",{value:"accepted",children:"Accepted"}),(0,t.jsx)("option",{value:"declined",children:"Declined"})]})]})]})]}),(0,t.jsxs)("div",{className:"bg-dark-card border border-dark-border rounded-2xl p-6",children:[(0,t.jsx)("h2",{className:"font-clash text-lg font-semibold mb-4",children:"Proposal Content"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:V,children:"Hero Title"}),(0,t.jsx)("input",{type:"text",value:b,onChange:e=>g(e.target.value),className:M})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:V,children:"Hero Subtitle"}),(0,t.jsx)("textarea",{value:v,onChange:e=>j(e.target.value),className:`${M} resize-none`,rows:2,placeholder:"Custom tagline for this client"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:V,children:"Personal Note (optional)"}),(0,t.jsx)("textarea",{value:N,onChange:e=>f(e.target.value),className:`${M} resize-none`,rows:2,placeholder:"A personal note shown at the top of the proposal"})]})]})]}),(0,t.jsxs)("div",{className:"bg-dark-card border border-dark-border rounded-2xl p-6",children:[(0,t.jsx)("h2",{className:"font-clash text-lg font-semibold mb-4",children:"Pricing"}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"space-y-3 p-4 rounded-xl border border-accent-purple/20 bg-accent-purple/5",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-accent-purple",children:"Option 1 (Recommended)"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:V,children:"Name"}),(0,t.jsx)("input",{type:"text",value:y,onChange:e=>w(e.target.value),className:M})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:V,children:"Price ($/month)"}),(0,t.jsx)("input",{type:"number",value:S,onChange:e=>C(Number(e.target.value)),className:M})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:V,children:"Description"}),(0,t.jsx)("input",{type:"text",value:P,onChange:e=>E(e.target.value),className:M})]})]}),(0,t.jsxs)("div",{className:"space-y-3 p-4 rounded-xl border border-dark-border",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-dark-text-light",children:"Option 2"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:V,children:"Name"}),(0,t.jsx)("input",{type:"text",value:$,onChange:e=>T(e.target.value),className:M})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:V,children:"Price ($/month)"}),(0,t.jsx)("input",{type:"number",value:B,onChange:e=>D(Number(e.target.value)),className:M})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:V,children:"Description"}),(0,t.jsx)("input",{type:"text",value:A,onChange:e=>O(e.target.value),className:M})]})]})]})]}),(0,t.jsxs)("div",{className:"bg-dark-card border border-dark-border rounded-2xl p-6",children:[(0,t.jsx)("h2",{className:"font-clash text-lg font-semibold mb-4",children:"Services"}),(0,t.jsx)("div",{className:"space-y-3",children:d.map(e=>(0,t.jsxs)("div",{className:`p-4 rounded-xl border transition-colors ${F[e.id]?.enabled?"border-accent-green/20 bg-accent-green/5":"border-dark-border bg-dark-bg/30 opacity-60"}`,children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("button",{type:"button",onClick:()=>{var t;return t=e.id,void L(e=>({...e,[t]:{...e[t],enabled:!e[t].enabled}}))},className:`w-5 h-5 rounded border flex items-center justify-center shrink-0 ${F[e.id]?.enabled?"bg-accent-green border-accent-green text-white":"border-dark-border"}`,children:F[e.id]?.enabled&&(0,t.jsx)("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"3",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})}),(0,t.jsx)("span",{className:"text-lg",children:e.icon}),(0,t.jsx)("span",{className:"font-medium text-sm",children:e.title}),e.subtitle&&(0,t.jsxs)("span",{className:"text-xs text-dark-text",children:["(",e.subtitle,")"]})]}),F[e.id]?.enabled&&(0,t.jsx)("div",{className:"mt-3 ml-8",children:(0,t.jsx)("input",{type:"text",value:F[e.id]?.custom_summary||"",onChange:t=>L(s=>({...s,[e.id]:{...s[e.id],custom_summary:t.target.value}})),className:`${M} text-xs`,placeholder:"Custom summary (leave blank to use default)"})})]},e.id))})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("button",{type:"submit",disabled:n,className:"px-6 py-2.5 rounded-lg bg-gradient-to-r from-accent-pink to-accent-purple text-white font-medium text-sm disabled:opacity-50",children:n?"Saving...":l?"Update Proposal":"Create Proposal"}),l&&(0,t.jsx)("a",{href:`/proposal/${e.slug}`,target:"_blank",rel:"noopener noreferrer",className:"px-6 py-2.5 rounded-lg border border-dark-border text-white text-sm hover:bg-white/5 transition-colors",children:"Preview"}),(0,t.jsx)("button",{type:"button",onClick:()=>a.push("/admin"),className:"px-6 py-2.5 rounded-lg text-dark-text text-sm hover:text-white transition-colors",children:"Cancel"})]})]})}e.s(["default",()=>a])},58074,e=>{"use strict";var t=e.i(19873),s=e.i(11833),r=e.i(33094),a=e.i(13922);let l={viewed:{label:"Viewed",color:"#FDCB6E"},accepted:{label:"Accepted",color:"#00B894"},declined:{label:"Declined",color:"#FF4D6A"},service_clicked:{label:"Service Clicked",color:"#0984E3"},pricing_viewed:{label:"Pricing Viewed",color:"#6C5CE7"}};function d({events:e}){return 0===e.length?(0,t.jsx)("p",{className:"text-dark-text text-sm",children:"No events recorded yet."}):(0,t.jsx)("div",{className:"space-y-3",children:e.map(e=>{let s=l[e.event_type]||{label:e.event_type,color:"#8B8B9E"};return(0,t.jsxs)("div",{className:"flex items-start gap-3 p-3 rounded-xl bg-dark-bg/50 border border-dark-border",children:[(0,t.jsx)("div",{className:"w-2.5 h-2.5 rounded-full mt-1 shrink-0",style:{backgroundColor:s.color}}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-sm font-medium",style:{color:s.color},children:s.label}),e.metadata&&e.metadata.service_id&&(0,t.jsx)("span",{className:"text-xs text-dark-text bg-dark-card px-2 py-0.5 rounded",children:e.metadata.service_id})]}),(0,t.jsx)("div",{className:"text-xs text-dark-text mt-0.5",children:new Date(e.created_at).toLocaleString()})]})]},e.id)})})}var i=e.i(29044);function n(){let e=(0,r.useParams)().id,[l,n]=(0,s.useState)(null),[c,o]=(0,s.useState)(!0);if((0,s.useEffect)(()=>{fetch(`/api/proposals/${e}`).then(e=>e.json()).then(e=>{n(e),o(!1)}).catch(()=>o(!1))},[e]),c)return(0,t.jsx)("div",{className:"text-dark-text",children:"Loading proposal..."});if(!l)return(0,t.jsx)("div",{className:"text-red-400",children:"Proposal not found"});let x=l.proposal_events||[],m=x.filter(e=>"viewed"===e.event_type).length,p=[...new Set(x.filter(e=>"service_clicked"===e.event_type).map(e=>e.metadata?.service_id).filter(Boolean))];return(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-1",children:[(0,t.jsx)("h1",{className:"font-clash text-3xl font-bold",children:l.client_name}),(0,t.jsx)(i.default,{status:l.status})]}),(0,t.jsx)("p",{className:"text-dark-text",children:"Edit proposal and view analytics"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{className:"bg-dark-card border border-dark-border rounded-xl p-4",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-accent-pink",children:m}),(0,t.jsx)("div",{className:"text-xs text-dark-text",children:"Total Views"})]}),(0,t.jsxs)("div",{className:"bg-dark-card border border-dark-border rounded-xl p-4",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-accent-blue",children:p.length}),(0,t.jsx)("div",{className:"text-xs text-dark-text",children:"Services Explored"})]}),(0,t.jsxs)("div",{className:"bg-dark-card border border-dark-border rounded-xl p-4",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-accent-purple",children:x.filter(e=>"pricing_viewed"===e.event_type).length}),(0,t.jsx)("div",{className:"text-xs text-dark-text",children:"Pricing Views"})]}),(0,t.jsxs)("div",{className:"bg-dark-card border border-dark-border rounded-xl p-4",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-accent-green",children:x.length}),(0,t.jsx)("div",{className:"text-xs text-dark-text",children:"Total Events"})]})]}),p.length>0&&(0,t.jsxs)("div",{className:"bg-dark-card border border-dark-border rounded-xl p-4",children:[(0,t.jsx)("h3",{className:"text-sm font-medium mb-2",children:"Services Explored"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:p.map(e=>(0,t.jsx)("span",{className:"px-2.5 py-1 rounded-lg bg-accent-blue/10 text-accent-blue text-xs",children:e},e))})]}),(0,t.jsxs)("div",{className:"bg-dark-card border border-dark-border rounded-2xl p-6",children:[(0,t.jsx)("h2",{className:"font-clash text-lg font-semibold mb-4",children:"Event Timeline"}),(0,t.jsx)(d,{events:x})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"font-clash text-lg font-semibold mb-4",children:"Edit Proposal"}),(0,t.jsx)(a.default,{proposal:l})]})]})}e.s(["default",()=>n],58074)}]);